<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6331195744309280"
     crossorigin="anonymous"></script>
  <title>SHA1 雜湊產生器｜Roy Dreambox</title>
<meta name="description" content="SHA1 雜湊產生器：可加入 Salt、指定前後位置，自動產生 40 位 SHA1 值，並提供複製與資訊提示。免費免安裝，線上可用。">

  <link rel="stylesheet" href="/global.css">
  <link rel="stylesheet" href="/css/loyui.css">
  <script src="/js/loadHeader.js"></script>

  <style>
    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px 16px 60px;
    }

    .loy-textarea {
      width: 100%;
      min-height: 200px;
      resize: vertical;
      padding: 12px 14px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--card-bg);
      font-size: 14px;
      line-height: 1.6;
      font-family: "Noto Sans TC", sans-serif;
      box-sizing: border-box;
      transition: 0.2s;
    }
    .loy-textarea:focus {
      outline: none;
      border-color: var(--loy-blue);
      box-shadow: 0 0 0 3px rgba(106,167,255,0.35);
    }

    .loy-input {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--card-bg);
      font-size: 14px;
      box-sizing: border-box;
      transition: 0.2s;
    }
    .loy-input:focus {
      outline: none;
      border-color: var(--loy-blue);
      box-shadow: 0 0 0 3px rgba(106,167,255,0.35);
    }

    .loy-label {
      margin-top: 10px;
      font-size: 14px;
      font-weight: 600;
      display: block;
    }

    .option-row {
      margin-top: 6px;
      font-size: 13px;
      color: #666;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .hash-output-row {
      display: flex;
      gap: 8px;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    .hash-output-row input {
      flex: 1;
      min-width: 0;
    }

    #hashInfo {
      margin-top: 6px;
      font-size: 12px;
      color: #777;
    }

    /* 複製成功提示 */
    #copyMsg {
      margin-top: 8px;
      font-size: 13px;
      color: var(--loy-blue);
      display: none;
      opacity: 0;
      transition: opacity 0.4s;
    }
  </style>
</head>

<body>
  <div id="header"></div>
  <script>
    loadHeader("編碼解碼工具", "SHA1 雜湊產生器");
  </script>

  <main>
    <h1>SHA1 雜湊產生器</h1>
    <p>輸入要計算 SHA1 的文字，可選擇是否加入 Salt。結果為 40 位十六進位雜湊值。</p>
    <section class="loy-card" style="margin-top:16px;">
      <div class="loy-card-title">輸入文字</div>

      <textarea id="inputText" class="loy-textarea"
        placeholder="在此輸入要進行 SHA1 計算的內容"></textarea>

      <label class="loy-label">Salt（可選）</label>
      <input id="saltValue" class="loy-input" placeholder="例如：mySecretSalt">

      <div class="option-row">
        <label>
          <input type="checkbox" id="useSalt" checked>
          使用 Salt 參與計算
        </label>

        <span>| Salt 位置：</span>
        <label>
          <input type="radio" name="saltPos" value="prefix" checked>
          前面（Salt + 原文）
        </label>
        <label>
          <input type="radio" name="saltPos" value="suffix">
          後面（原文 + Salt）
        </label>
      </div>

      <div style="margin-top:14px; text-align:right;">
        <button id="btnHash" class="tool-btn">產生 SHA1 雜湊</button>
      </div>
    </section>
    <section class="loy-card" style="margin-top:20px;">
      <div class="loy-card-title">結果</div>

      <div class="hash-output-row">
        <input id="hashOutput" class="loy-input"
               placeholder="SHA1 雜湊結果會顯示在這裡" readonly>
        <button id="btnCopy" class="tool-btn secondary">複製</button>
      </div>

      <div id="hashInfo">尚未計算。</div>
      <div id="copyMsg">✔ 已複製雜湊結果</div>
    </section>
  </main>

  <script>
    async function sha1(message) {
      if (!window.crypto || !window.crypto.subtle) {
        throw new Error("此瀏覽器不支援 SHA1 計算");
      }
      const encoder = new TextEncoder();
      const data = encoder.encode(message);
      const buf = await crypto.subtle.digest("SHA-1", data);
      const bytes = Array.from(new Uint8Array(buf));
      return bytes.map(b => b.toString(16).padStart(2, "0")).join("").toUpperCase();
    }

    const inputEl = document.getElementById("inputText");
    const saltEl  = document.getElementById("saltValue");
    const useSaltEl = document.getElementById("useSalt");
    const hashEl  = document.getElementById("hashOutput");
    const hashInfoEl = document.getElementById("hashInfo");
    const copyMsgEl  = document.getElementById("copyMsg");

    // 開關 Salt 相關欄位
    useSaltEl.addEventListener("change", () => {
      const on = useSaltEl.checked;
      saltEl.disabled = !on;
      document.querySelectorAll("input[name='saltPos']").forEach(r => {
        r.disabled = !on;
      });
    });
    document.getElementById("btnHash").onclick = async () => {
      const text = inputEl.value;
      if (!text.trim()) {
        warnMsgEl.textContent = "請先輸入要計算的文字";
		warnMsgEl.style.display = "block";
		setTimeout(() => (warnMsgEl.style.opacity = 1), 10);
        return;
      }

      let salt = "";
      let useSalt = useSaltEl.checked;
      if (useSalt) {
        salt = saltEl.value;
        if (!salt) {
          useSalt = false;
        }
      }

      let finalText = text;
      let saltPos = document.querySelector("input[name='saltPos']:checked").value;

      if (useSalt) {
        if (saltPos === "prefix") finalText = salt + text;
        else finalText = text + salt;
      }

      try {
        hashInfoEl.textContent = "計算中…";
        const hash = await sha1(finalText);
        hashEl.value = hash;

        const lenText = text.length;
        const lenSalt = useSalt ? salt.length : 0;
        const lenFinal = finalText.length;

        hashInfoEl.textContent =
          `已完成計算：原文 ${lenText} 字元，Salt ${lenSalt} 字元，合併後 ${lenFinal} 字元。`;
      } catch (e) {
        console.error(e);
        alert("瀏覽器不支援或計算失敗，請換一個瀏覽器再試試。");
      }
    };
    document.getElementById("btnCopy").onclick = async () => {
      const v = hashEl.value.trim();
      if (!v) return;
      await navigator.clipboard.writeText(v);

      copyMsgEl.style.display = "block";
      copyMsgEl.style.opacity = "1";

      setTimeout(() => {
        copyMsgEl.style.opacity = "0";
        setTimeout(() => { copyMsgEl.style.display = "none"; }, 400);
      }, 1500);
    };

  </script>


	
  <div id="warnMsg"></div>
  <div id="global-buttons"></div>
  <script src="/js/global.js"></script>
  <script src="/js/loyui.js"></script>

</body>
</html>
